<!doctype html>
<html lang="ru ">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Parser NAU</title>
    <style>
        #container {
            width: 100%;
            position: absolute;
            right: 0;
        }

        #container1 {
            width: 100%;
            position: absolute;
            left: 0;
        }
        @media (min-width: 900px) {
            #container {
                width: 50%;
                position: absolute;
                right: 0;
            }

            #container1 {
                width: 50%;
                position: absolute;
                left: 0;
            }
        }

        .table_project {
            overflow-x: hidden;
            font-size: 22px;
            margin-left: 5%;
            margin-right: 5%;
            width: 90%;
        }

        img {
            height: 40px;
            width: 40px;
        }

        .reload {
            position: fixed;
            left: 25px;
            top: 80px;
            height: 60px;
            width: 50px;
        }

        .sortUp:hover, .sortDown:hover {
            cursor: pointer;
        }

        .down {
            transform: rotate(180deg);
        }

        @media (min-width: 500px) and (max-width: 900px) {
            .table_project {
                overflow-x: hidden;
                font-size: 15px;
                width: 100%;
            }

            img {
                height: 30px;
                width: 30px;
            }
        }

        @media (max-width: 500px) {
            .table_project {
                font-size: 10px;
                margin: 0;
                width: 100%;
            }

            img {
                height: 30px;
                width: 30px;
            }

            .big {
                font-size: 12px;
            }
        }

    </style>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
</head>
<body>
<div class="table_project">
    <h2 class="friend text-center">Проекти команди НАУ</h2>
    <hr>
    <div class="row">
        <div class="col-1 text-center number">№</div>
        <div class="col-3 pr-0 amount">Назва<br/>Бюджет
            <img src="../images/iconfinder_chevron-circle-down_1608620.svg" class="sortUp" alt="sort"></div>
        <div class="col-1 pl-0 full_info mr-2 text-center">Всього
            <img src="../images/iconfinder_chevron-circle-down_1608620.svg" class="sortUp" alt="sort">
        </div>
        <div class="col-1 pl-0 10min_info text-center ">10хв
            <img src="../images/iconfinder_chevron-circle-down_1608620.svg" class="sortUp" alt="sort"></div>
        <div class="col-1 pl-0 1h_info text-center ">1год
            <img src="../images/iconfinder_chevron-circle-down_1608620.svg" class="sortUp" alt="sort"></div>
        <div class="col-1 pl-0 3h_info text-center">3год
            <img src="../images/iconfinder_chevron-circle-down_1608620.svg" class="sortUp" alt="sort"></div>
        <div class="col-1 pl-0 6h_info text-center">6год
            <img src="../images/iconfinder_chevron-circle-down_1608620.svg" class="sortUp" alt="sort"></div>
        <div class="col-1 pl-0 12h_info text-center">12год
            <img src="../images/iconfinder_chevron-circle-down_1608620.svg" class="sortUp" alt="sort"></div>
        <div class="col-1 pl-0 24h_info text-center">24год
            <img src="../images/iconfinder_chevron-circle-down_1608620.svg" class="sortUp" alt="sort"></div>

    </div>
    <hr>
    <% data.forEach(function (value1, index) { %>
    <div class="row sort_rows">
        <div class="col-1 number"><%= value1.number %></div>
        <div class="col-3 project_link pr-0 mr-2">
            <a href="<%=value1.link %>"> <%= value1.name %></a><br/><div class="amount"><%= value1.amount %></div></div>
        <div class="col-1 pl-0  text-center full_info"><%= value1.suffrage %></div>
        <div class="col-1 text-center pl-0 10min_info"><%= value1.ten %></div>
        <div class="col-1 text-center pl-0 1h_info"><%= value1.hour1 %></div>
        <div class="col-1 text-center pl-0 3h_info"><%= value1.hour3 %></div>
        <div class="col-1 text-center pl-0 6h_info"><%= value1.hour6 %></div>
        <div class="col-1 text-center pl-0 12h_info"><%= value1.hour12 %></div>
        <div class="col-1 text-center pl-0 24h_info"><%= value1.hour24 %></div>

    </div>
    <hr>
    <% if(index == 11) { %>
    <h2 class="friend hide text-center">Дружні проекти</h2>
    <hr class="friend hide">
    <% } %>
    <% }); %>
</div>
<div id="container" style="height: "></div>
<div id="container1"></div>

<script src="https://code.jquery.com/jquery-3.3.1.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" type="text/javascript"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" type="text/javascript"></script>
<script src="/javascripts/sort.js" type="text/javascript"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/series-label.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>
<script>
    var data = [];
    let series = [];
    let seriesSUM = [];
    $.ajax({
        url: '/select',
        complete: function(dataJSON) {
            //console.log(dataJSON.responseJSON.data);
            data = JSON.parse(dataJSON.responseJSON.data);
            data.forEach(function (value,index) {
                let obj = {
                    name: value.number,
                    data: value.data
                };
                let objSUM = {
                    name: value.number,
                    data: value.dataSUM
                };
                series.push(obj);
                seriesSUM.push(objSUM);
            });
            console.log(series);
            console.log(seriesSUM);
            create("container",series,"Часова статистика");
            create("container1",seriesSUM, "Сумарна статистика");
        }
    });
    function create(container,series,text) {
        Highcharts.chart(container, {

            title: {
                text: text
            },

            subtitle: {
                text: ''
            },

            yAxis: {
                title: {
                    text: 'Кількість голосів'
                }
            },
            legend: {
                layout: 'vertical',
                align: 'right',
                verticalAlign: 'middle'
            },

            plotOptions: {
                series: {
                    label: {
                        connectorAllowed: false
                    },
                    pointStart: 1
                }
            },
            series: series,

            responsive: {
                rules: [{
                    condition: {
                        maxWidth: 500
                    },
                    chartOptions: {
                        legend: {
                            layout: 'horizontal',
                            align: 'center',
                            verticalAlign: 'bottom'
                        }
                    }
                }]
            }

        });
    }
</script>
</body>
</html>